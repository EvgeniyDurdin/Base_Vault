[Исходная статья](https://docs.oracle.com/en/database/oracle/oracle-database/21/tgsql/joins.html#GUID-5435FC78-D572-4CEE-A733-CDB1DB8E544B)

У СУБД ORACLE есть несколько оптимизаций для объединения наборов строк

### 1. Описание 
`join` объединяет данные ровно двух наборов строк, таких как таблицы или представления и возвращает одни набор строк.
`join` характеризуется наличием нескольких таблиц в `WHERE` (non-ANST) или `FROM ... JOIN` (ANSI). Всякий раз когда в `FROM` находятся несколько таблиц, Oracle выполняет `join`.
- `join condition` (условие соединения) - условие, которое сравнивает два источника строк с использованием выражения. База данных объединяет пары строк, каждая из которых содержит по одной строке из каждого источника строк, для которых условие равно true.
- `join elimination` (исключение соединения) - удаление избыточных таблиц из запроса. Таблица является избыточной, если на ее столбцы ссылаются только в предикатах объединения, и эти объединения гарантированно не будут ни фильтровать, ни расширять результирующие строки.
- `join predicate` (предикат соединения) - предикат в инструкции `WHERE` или `JOIN`, который объединяет столбцы двух таблиц.

### 2. Деревья соединений
Обычно дерево соединений представляется в виде перевернутой древовидной структуры.
Как показано на следующем рисунке, `table1` это левая таблица, а `table2` это правая таблица. Оптимизатор обрабатывает объединение слева направо. Например, если на этом рисунке изображено объединение вложенных циклов, то `table1` это внешний цикл, а `table2` - внутренний цикл.
![[SQL/Oracle/content/Oracle_9.2.1.png]]
Входом объединения может быть результирующий набор из предыдущего объединения. Если правым дочерним элементом каждого внутреннего узла дерева соединений является таблица, то дерево является **левым глубоким деревом соединений**, как показано в следующем примере. Большинство деревьев соединений оставлены глубокими соединениями.
![[Oracle_9.2.2.png]]
Если левым дочерним элементом каждого внутреннего узла дерева соединений является таблица, то дерево называется **правым глубоким деревом соединений**, как показано на следующей диаграмме.
![[Oracle_9.2.3.png]]
Если левый или правый дочерний элемент внутреннего узла дерева объединения может быть узлом объединения, тогда дерево называется **кустистым деревом соединения**. В следующем примере `table4` является правым дочерним элементом узла объединения, `table1` является левым дочерним элементом узла объединения и `table2` является левым дочерним элементом узла объединения.
![[Oracle_9.2.4.png]]

### 3. Как оптимизатор выбирает планы выполнения для объединений
При определении порядка и метода объединения целью оптимизатора является скорейшее уменьшение количества строк, чтобы он выполнял меньше работы в последующих инструкциях SQL.
Оптимизатор генерирует набор планов выполнения в соответствии с возможными порядками объединения, методами объединения и доступными путями доступа. Затем оптимизатор оценивает стоимость каждого плана и выбирает тот, которые имеет наименьшую стоимость. При выборе плана выполнения оптимизатор учитывает следующие факторы:
- сначала определяется приведет ли объединение одной или более таблиц к получению набора данных из одной строки. Оптимизатор распознает такие ситуации на основе `UNIQUE` и `PRIMARY KEY` ограничений в таблицах. Если такая ситуация существуют, то эти таблицы будут первыми в порядке объединения.
- 